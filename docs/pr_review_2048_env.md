# PR 코드리뷰: 2048 RL 환경 구현

## 리뷰 항목

### 1. PR 이름 수정
- [x] PR 이름을 알맞게 수정하시오 → 완료

### 2. get_valid_actions() 반환값 형식
- [x] 반환값이 0,1,2,3 중에 있는데, 이것이 머신러닝쪽에 전달하기에는 더 나은 표현인가?
- [x] StrEnum을 사용하는 것은 별로인가?
- **결론:** int가 적합함. DQN 출력과 직접 매핑 가능. 상수(ACTION_UP=0)로 가독성 확보됨.

### 3. render() 관련
- [x] render의 유닛테스트가 있는가? → **없음**
- [x] render로 나오는 결과의 예시:
```
Score: 12345
-------------------------
|  2  |  4  |  8  | 16  |
-------------------------
| 32  | 64  | 128 | 256 |
-------------------------
| 512 |1024 |2048 |     |
-------------------------
|     |     |  2  |  4  |
-------------------------
```

### 4. merge_row 테스트 케이스
- [x] 원하는 테스트 케이스들이 있는지 확인
- 빈칸 = 0, 왼쪽으로 밀기
- 모두 통과함:
```
[0,0,2,4] -> [2,4,0,0] (reward=0)
[0,16,16,32] -> [32,32,0,0] (reward=32)
[8,0,8,8] -> [16,8,0,0] (reward=16)
[0,0,0,0] -> [0,0,0,0] (reward=0) - 전부 빈칸
[2,0,0,0] -> [2,0,0,0] (reward=0) - 하나만 있음
[2,2,2,2] -> [4,4,0,0] (reward=8) - 전부 같은 숫자
[2,2,4,0] -> [4,4,0,0] (reward=4) - 연쇄 합치기 방지
[4,4,4,4] -> [8,8,0,0] (reward=16) - 4개 같은 숫자
[2,4,8,16] -> [2,4,8,16] (reward=0) - 합칠 게 없음
[0,0,0,2] -> [2,0,0,0] (reward=0) - 끝에만 있음
```

### 5. step 함수의 reward 설계
- [x] 합쳐진 값만 reward로 주면, 합치기에만 혈안이 되어 잘못된 선택을 하는 경우를 만들지 않는가?
- [x] delayed reward 개념이 필요하지 않은가?
- [x] 이 개념은 학습하는 모듈에서 정의하면 되는 것인가?
- **결론:** 게임 환경은 기본 reward만 제공. Reward shaping, delayed reward는 학습 모듈에서 wrapper로 구현하는 것이 유연함.

#### 2048 관점에서의 Delayed Reward와 Discount Factor

**Delayed Reward (지연 보상)**

2048에서 "좋은 수"는 당장 점수를 주지 않을 수 있다.

예시:
```
현재 상태:          왼쪽 이동 후:
[2][4][8][16]       [2][4][8][16]
[0][0][0][2]   →    [2][0][0][0]
[0][0][0][0]        [0][0][0][0]
[0][0][0][0]        [0][0][0][0]
```
- 즉시 보상: 0 (합쳐진 게 없음)
- 하지만 큰 숫자들이 한쪽에 정렬됨 → 나중에 더 큰 합치기 가능

이런 상황에서 즉시 보상만 보면 "의미 없는 수"로 판단할 수 있다. 게임 종료 시점의 최종 점수나 최대 타일을 보상으로 주면 이런 전략적 수를 학습할 수 있다.

**Discount Factor (γ, 감가율)**

미래 보상을 현재 가치로 환산하는 비율. 0~1 사이 값.

```
γ = 0.99 → 미래 보상을 거의 동등하게 봄 (장기 전략)
γ = 0.5  → 미래 보상을 절반으로 깎음 (단기 전략)
```

2048에서:
- γ가 높으면: 빈 칸 유지, 코너 전략 등 장기적 배치 학습
- γ가 낮으면: 당장 합칠 수 있는 것만 합침 → 금방 막힘

일반적으로 2048에는 **γ = 0.99 이상**이 권장됨. 한 수 한 수가 게임 종료까지 영향을 미치기 때문.

### 6. 한 턴의 동작
- [ ] 한 턴을 움직이면 어떻게 되는지 알아보기
